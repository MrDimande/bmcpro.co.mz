---
import BMCLogo from './BMCLogo.astro';
import { ChevronDown } from 'lucide-astro';

const navItems = [
	{ label: 'InÃ­cio', href: '/', active: true },
	{ label: 'PorquÃª NÃ³s', href: '/why-us' },
	{ label: 'ServiÃ§os', href: '/services' },
	{ label: 'Ecossistema', href: '/#ecosystem' },
	{ label: 'Processo', href: '/#process' },
];
---

<header class="fixed top-0 left-0 right-0 z-50 py-4 bg-transparent">
	<nav class="container mx-auto px-4 sm:px-6 flex items-center justify-between">
		<!-- Logo -->
		<a href="/" class="flex items-center gap-2.5 group">
			<div class="relative">
				<BMCLogo class="text-gold-500 group-hover:scale-105 transition-transform duration-300" size={38} />
				<!-- Subtle glow on hover -->
				<div class="absolute inset-0 bg-gold-500/20 rounded-full blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
			</div>
			<div class="flex flex-col">
				<span class="text-lg font-bold text-gold-500 leading-none tracking-tight">BMC Pro</span>
				<span class="text-[8px] text-gray-500 font-medium uppercase tracking-[0.15em] mt-0.5">Business Management Consultant</span>
			</div>
		</a>

		<!-- Desktop Menu - Pill Container -->
		<div class="hidden lg:flex items-center">
			<div class="flex items-center gap-1 px-2 py-1.5 rounded-full bg-white/5 backdrop-blur-xl border border-white/10">
				{navItems.map((item) => (
					<a 
						href={item.href} 
						class:list={[
							"px-5 py-2 rounded-full text-sm font-medium transition-all duration-300",
							item.active 
								? "bg-white/10 text-white shadow-lg" 
								: "text-gray-300 hover:text-white hover:bg-white/5"
						]}
					>
						{item.label}
					</a>
				))}
			</div>
		</div>

		<!-- Right Side -->
		<div class="flex items-center gap-3">
			<!-- Language Selector -->
			<div class="hidden md:flex items-center gap-1.5 px-2 py-1 rounded-full bg-white/5 backdrop-blur-xl border border-white/10">
				<a
					href="/"
					class="flex items-center gap-1.5 px-2 py-1 rounded-full text-xs font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors"
				>
					<span>ðŸ‡²ðŸ‡¿</span>
					<span>PT</span>
				</a>
				<a
					href="/en"
					class="flex items-center gap-1.5 px-2 py-1 rounded-full text-xs font-medium text-gray-300 hover:text-white hover:bg-white/10 transition-colors"
				>
					<span>ðŸ‡¬ðŸ‡§</span>
					<span>EN</span>
				</a>
			</div>
			
			<!-- Contact Button -->
			<a 
				href="/contact" 
				class="hidden sm:inline-flex px-4 sm:px-6 py-2 sm:py-2.5 rounded-full bg-gradient-to-r from-gold-500 to-gold-400 text-dark-200 font-semibold text-xs sm:text-sm shadow-lg shadow-gold-500/25 hover:shadow-gold-500/40 hover:scale-105 transition-all duration-300"
			>
				Contact Us
			</a>

			<!-- Mobile Menu Button -->
			<button 
				id="mobile-menu-btn" 
				class="lg:hidden w-10 h-10 flex flex-col items-center justify-center gap-1.5 rounded-full bg-white/5 backdrop-blur-xl border border-white/10"
				aria-label="Toggle menu"
			>
				<span class="menu-line w-5 h-0.5 bg-gold-500 transition-all duration-300 origin-center"></span>
				<span class="menu-line w-5 h-0.5 bg-gold-500 transition-all duration-300"></span>
				<span class="menu-line w-5 h-0.5 bg-gold-500 transition-all duration-300 origin-center"></span>
			</button>
		</div>
	</nav>

	<!-- Mobile Menu -->
	<div id="mobile-menu" class="hidden lg:hidden absolute top-full left-4 right-4 mt-2 rounded-2xl bg-black/80 backdrop-blur-xl border border-white/10 overflow-hidden">
		<ul class="p-4 flex flex-col gap-1">
			{navItems.map((item) => (
				<li>
					<a 
						href={item.href} 
						class:list={[
							"block px-4 py-3 rounded-xl text-sm font-medium transition-all duration-300",
							item.active 
								? "bg-gold-500/20 text-gold-500" 
								: "text-gray-300 hover:text-white hover:bg-white/5"
						]}
					>
						{item.label}
					</a>
				</li>
			))}
			<li class="mt-2 pt-2 border-t border-white/10">
				<a 
					href="/contact" 
					class="block px-4 py-3 rounded-xl bg-gradient-to-r from-gold-500 to-gold-400 text-dark-200 font-semibold text-sm text-center"
				>
					Contact Us
				</a>
			</li>
		</ul>
	</div>
</header>

<script>
	const menuBtn = document.getElementById('mobile-menu-btn');
	const mobileMenu = document.getElementById('mobile-menu');
	const menuLines = menuBtn?.querySelectorAll('.menu-line');
	
	if (menuBtn && mobileMenu) {
		menuBtn.addEventListener('click', () => {
			const isOpen = !mobileMenu.classList.contains('hidden');
			
			if (isOpen) {
				mobileMenu.classList.add('hidden');
				// Reset hamburger
				if (menuLines) {
					menuLines[0].classList.remove('rotate-45', 'translate-y-2');
					menuLines[1].classList.remove('opacity-0');
					menuLines[2].classList.remove('-rotate-45', '-translate-y-2');
				}
			} else {
				mobileMenu.classList.remove('hidden');
				// Animate to X
				if (menuLines) {
					menuLines[0].classList.add('rotate-45', 'translate-y-2');
					menuLines[1].classList.add('opacity-0');
					menuLines[2].classList.add('-rotate-45', '-translate-y-2');
				}
			}
		});
	}

	// Active state based on current path
	if (typeof window !== 'undefined') {
		const currentPath = window.location.pathname;
		document.querySelectorAll('nav a').forEach(link => {
			const href = link.getAttribute('href');
			if (href === currentPath || (href === '/' && currentPath === '/')) {
				link.classList.add('bg-white/10', 'text-white');
				link.classList.remove('text-gray-300');
			}
		});
	}
</script>

<style>
	/* Header scroll effect */
	header {
		transition: all 0.3s ease;
		background: transparent;
	}

	header.scrolled {
		background: rgba(0, 0, 0, 0.6);
		backdrop-filter: blur(12px);
		border-bottom: 1px solid rgba(255, 184, 0, 0.1);
	}

	/* Mobile menu animation */
	#mobile-menu {
		animation: slideDown 0.3s ease;
	}

	@keyframes slideDown {
		from {
			opacity: 0;
			transform: translateY(-10px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	/* Hamburger to X animation */
	.menu-line {
		transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
	}
</style>

<script>
	// Add scroll effect
	if (typeof window !== 'undefined') {
		const header = document.querySelector('header');
		
		const handleScroll = () => {
			if (window.scrollY > 50) {
				header?.classList.add('scrolled');
			} else {
				header?.classList.remove('scrolled');
			}
		};

		window.addEventListener('scroll', handleScroll);
		handleScroll(); // Check initial state
	}
</script>

